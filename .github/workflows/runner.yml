name: Test Pipeline

on: [push]

jobs:
  cypress-job:
    runs-on: ubuntu-latest

    steps:
    - name: Setup
      uses: actions/checkout@v4

    - name: Run Cypress Test
      uses: cypress-io/github-action@v6  
      with:
        record: true
        parallel: true
      env:
        CYPRESS_MAILSLURP_API_KEY: ${{secrets.CYPRESS_MAILSLURP_API_KEY}}
        CYPRESS_RECORD_KEY: ${{ secrets.CYPRESS_RECORD_KEY }}
    - run: node report.js 


    - name: Save Report
      uses: actions/upload-artifact@v2
      with:
        name: test-reports  
        path: |
          cypress/reports/html/cucumber-report/